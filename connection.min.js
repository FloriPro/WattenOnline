function getCookie(e){var n,o,t,a;n=document.cookie;o=e+"=";t=n.indexOf("; "+o);a=n.length;if(t!==-1){t+=2}else{t=n.indexOf(o);if(t===-1||t!==0)return null}if(n.indexOf(";",t)!==-1){a=n.indexOf(";",t)}return decodeURI(n.substring(t+o.length,a)).replace(/\"/g,"")}function neueIp(){document.cookie="serverIpAdress="+prompt("Ip adress:")+"; expires=Fri, 31 Dec 9999 23:59:59 GMT";n=new WebSocket("ws://"+getCookie("serverIpAdress")+":8000/")}if(getCookie("serverIpAdress")==null){document.cookie="serverIpAdress="+location.host+"; expires=Fri, 31 Dec 9999 23:59:59 GMT"}var o="none";var n;var a;var c;var t="None";var i=false;var d=false;function wsSend(e){if(d){n.send(e)}}function load(){document.getElementById("ConnectionInfo").style.color="rgb(255, 0, 0)";n=new WebSocket("ws://"+getCookie("serverIpAdress")+":8000/");var t=[];n.onclose=function(e){d=false;document.getElementById("ConnectionInfo").style.display="";document.getElementById("ConnectionInfo").innerText="Verbindung geschlossen! Neu Versuch initialisiert";if(document.getElementById("HauptSchlagImg")!=null){document.getElementById("HauptSchlagImg").remove()}document.getElementById("Msg").style.display="none";load()};n.onopen=function(e){console.log("ok");document.getElementById("position").style.display="inline-table";document.getElementById("startingConnection").style.display="none";document.getElementById("NeueIP").style.display="none";d=true;document.getElementById("ConnectionInfo").style.color="rgb(255, 0, 0)";document.getElementById("ConnectionInfo").style.display="none"};n.onerror=function(e){if(document.getElementById("startingConnection").style.display!="none"){console.log(e);document.getElementById("startingConnection").textContent="Verbindung fehlgeschlagen"}};n.onmessage=function(e){console.log(e.data);if(e.data.substring(0,2)=="PL"){document.title="Watten Online | Warten auf genug Spieler";p=e.data.substring(2,0);document.getElementById("waitingPlayer").innerHTML="Vorhandene Spieler: "+e.data.substring(2,3)}if(e.data.substring(0,7)=="YourSel"){document.title="Watten Online | Karte legen";o="YourSel";document.getElementById("Msg").textContent="Lege eine Karte:";document.getElementById("Msg").style.display="unset"}if(e.data.substring(0,3)=="IT:"){document.querySelectorAll(".yourCard").forEach(e=>{e.remove()});e.data.substring(3,999).split("#").forEach(function(e,n,o){t.push(e);document.getElementById("yourCards").innerHTML+='<a class="yourCard" href="#" width="25%" height="25%"><img alt="'+e+'" src="/deck/own/'+e+'.png" id="'+e+'" onclick="cardSelect(\''+e+"')\"></a>"});document.getElementById("SticheAnzahl").style.display="unset"}if(e.data.substring(0,2)=="FR"){document.title="Watten Online | Position auswählen";document.querySelectorAll(".posSel").forEach(e=>{e.style.display="none"});if(e.data!="FR_"){e.data.substring(3,999).split("#").forEach(function(e,n,o){document.getElementById(e).style.display="unset"})}}if(e.data.substring(0,6)=="WaiOnP"){document.title="Watten Online | auf Spieler warten"}if(e.data.substring(0,5)=="clear"){document.getElementById("waiting").style.display="none";document.getElementById("game").style.display="block"}if(e.data.substring(0,7)=="waitSla"){document.getElementById("info").style.display="unset";document.getElementById("info").textContent="Warte auf die Auswahl vom Schlag";document.title="Watten Online | Warte auf Schlag"}if(e.data.substring(0,7)=="SelSla"){document.title="Watten Online | Schlag auswählen";o="selSla";document.getElementById("info").style.display="unset";document.getElementById("info").style.background="#0dff00";document.getElementById("info").textContent="Bitte Schlag auswählen"}if(e.data.substring(0,7)=="waitFar"){document.getElementById("info").style.display="unset";document.getElementById("info").textContent="Warte auf die Auswahl von Farbe | Schlag: "+c;document.title="Watten Online | Warte auf Farbe"}if(e.data.substring(0,7)=="SelFar"){document.title="Watten Online | Farbe auswählen";o="selFar";document.getElementById("info").style.display="unset";document.getElementById("info").style.background="#0dff00";document.getElementById("info").textContent="Bitte Farbe auswählen -- Schlag: "+c}if(e.data.substring(0,6)=="Stapel"){document.getElementById("layedCards").innerHTML="";if(e.data.substring(6,999)!=""){e.data.substring(6,999).split("#").forEach(function(e,n,o){t.push(e);document.getElementById("layedCards").innerHTML+='<img src="/deck/own/'+e+'.png" width="30%" height="30%" style="margin-right: -20%;" alt="'+e+'">'})}}if(e.data.substring(0,12)=="farSelected_"){console.log("selected Farbe: "+e.data.substring(12,13));a=e.data.substring(12,13);document.getElementById("Hauptschlagt").innerHTML+='<img id="HauptSchlagImg" width="20%" alt="'+a+"_"+c+'" src="/deck/own/'+a+"_"+c+'.png">';document.getElementById("info").style.display="none"}if(e.data.substring(0,12)=="slaSelected_"){console.log("selected Schlag: "+e.data.substring(12,14));c=e.data.substring(12,14)}if(e.data.substring(0,6)=="Stiche"){document.getElementById("SticheOL").textContent=e.data.substring(6,999).split("#")[0]+" Stich(e)";document.getElementById("SticheOR").textContent=e.data.substring(6,999).split("#")[1]+" Stich(e)";document.getElementById("SticheUR").textContent=e.data.substring(6,999).split("#")[2]+" Stich(e)";document.getElementById("SticheUL").textContent=e.data.substring(6,999).split("#")[3]+" Stich(e)"}if(e.data.substring(0,6)=="GotSti"){var n=e.data.substring(6,999);if(n=="Partner"){document.title="Watten Online | Dein Partner hat gestochen";addMessage("Dein Partner hat gestochen!")}if(n=="Du"){document.title="Watten Online | Du hast gestochen";addMessage("Du hast gestochen!")}if(n=="Gegner"){document.title="Watten Online | Deine Gegner haben diesen Stich bekommen";addMessage("Deine Gegner haben diesen Stich bekommen.")}}if(e.data=="NewGame"){document.title="Watten Online | Neues Spiel?";if(window.confirm("Nocheinmal?")){wsSend("Yes")}else{wsSend("No")}}if(e.data=="off"){window.alert("Watten Spiel Beendet!")}if(e.data=="reset"){document.title="Watten Online | Neues Spiel";console.warn("RESET");i=false;document.getElementById("yourCards").style.filter="";document.getElementById("layedCards").style.filter="";document.getElementById("Hauptschlagt").style.filter="";document.getElementById("Msg").style.filter="";document.getElementById("go_noGo").style.display="none";document.getElementById("go_noGo_selection").style.display="none";o="none";document.querySelector("#HauptSchlagImg").remove();document.getElementById("Msg").style.display="none";document.getElementById("layedCards").innerHTML="";a=undefined;c=undefined;o="none"}if(e.data.substring(0,19)=="waitingGehenAnswer_"){if(i==false){document.getElementById("yourCards").style.filter="grayscale(1)";document.getElementById("layedCards").style.filter="grayscale(1)";document.getElementById("Hauptschlagt").style.filter="grayscale(1)";document.getElementById("Msg").style.filter="grayscale(1)";document.getElementById("go_noGo").style.display=""}i=true;document.getElementById("go_noGo_text").innerText="Abstimmung findet stadt.\n Zurzeit haben "+e.data.substring(19,999)+" Spieler abgestimmt."}if(e.data=="wanaGo"){document.getElementById("go_noGo_selection").style.display="";document.getElementById("yourCards").style.filter="grayscale(1)";document.getElementById("layedCards").style.filter="grayscale(1)";document.getElementById("Hauptschlagt").style.filter="grayscale(1)";document.getElementById("Msg").style.filter="grayscale(1)";i=true;document.getElementById("go_noGo").style.display=""}if(e.data=="TheyGo"){addMessage("Die Gegner sind gegangen")}if(e.data=="weGo"){addMessage("Ihr seid gegangen")}if(e.data=="weNoGo"){addMessage("Ihr seid nicht gegangen")}if(e.data=="TheyNoGo"){addMessage("Die Gegner sind nicht gegangen")}if(e.data=="TheyNoGo"||e.data=="weNoGo"||e.data=="weGo"||e.data=="TheyGo"){console.log("ex");i=false;document.getElementById("yourCards").style.filter="";document.getElementById("layedCards").style.filter="";document.getElementById("Hauptschlagt").style.filter="";document.getElementById("Msg").style.filter="";document.getElementById("go_noGo").style.display="none"}}}window.addEventListener("load",load);function init(e){document.title="Watten Online";clearInterval(startUpdateLoop);t=e;document.getElementById("Stiche"+e).style.backgroundColor="crimson";wsSend(e);document.getElementById("position").style.display="none";document.getElementById("game").style.display="block"}startUpdateLoop=setInterval(function(){if(t=="None"){wsSend("None")}},250);function cardSelect(e){if(!i){document.title="Watten Online";document.getElementById("info").style.background="unset";console.log(e);if(o=="selSla"){wsSend(e);o=""}if(o=="selFar"){wsSend(e);o=""}if(o=="YourSel"){document.getElementById(e).remove();document.getElementById("Msg").style.display="none";wsSend(e);o=""}}}function weGo(){document.getElementById("go_noGo_selection").style.display="none";wsSend("True")}function weNoGo(){document.getElementById("go_noGo_selection").style.display="none";wsSend("False")}function youGo(){wsSend("AskIfwanaGo")}